app-id: org.jacktrip.JackTrip
runtime: org.kde.Platform
runtime-version: '5.15'
sdk: org.kde.Sdk
command: jacktrip
finish-args:
  # X11 + XShm access
  - --share=ipc
  - --socket=fallback-x11
  # Wayland access
  - --socket=wayland
  # Needs network access
  - --share=network
  # Pipewire/Jack
  - --filesystem=xdg-run/pipewire-0
  - --socket=system-bus
  - --socket=pulseaudio
  - --device=all
modules:
  # - name: pipewire
  #   buildsystem: meson
  #   config-opts:
  #     - -Djack-devel=enabled
  #     - -Dpipewire-alsa=disabled
  #   sources:
  #     - type: git
  #       url: https://gitlab.freedesktop.org/pipewire/pipewire.git
  - name: jack2
    buildsystem: simple
    build-commands:
      - ./waf configure --prefix=/app --htmldir=/app/share/doc/jack/ --classic
      - ./waf build -j $FLATPAK_BUILDER_N_JOBS
      - ./waf install
    sources:
      - type: archive
        url: https://github.com/jackaudio/jack2/archive/refs/tags/v1.9.18.tar.gz
        sha256: 5a1d64118034d58529d68a9af42710f9d4843536257c496118065ea3d3e4ae2c
    cleanup:
      - '*'
  - name: jacktrip
    buildsystem: meson
    sources:
      - type: git
        url: https://github.com/jacktrip/jacktrip.git
        branch: dev
